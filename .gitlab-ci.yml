stages:
  - build
  - test
  - deploy

image: docker:19.03.12
services:
  - docker:19.03.12-dind

build_backend:
  stage:
    - test
    - build
  before_script:
    - docker info
    - docker -v
  script:
    - docker build ./backend -t backend
    - docker run backend python manage.py test
    - docker run backend pytest

build_frontend:
  stage: build
  script:
    - echo "Here will go building frontend script"

test_frontend:
  stage: test
  needs: [build_frontend]
  script:
    - echo "Testing fronted script will go here!"

deploy_backend:
  stage: deploy
  needs:
    - build_backend
  script:
    - echo "Deploy backend script goes here."

deploy_fronted:
  stage: deploy
  needs:
    - test_frontend
  script:
    - echo "Deploy frontend script goes here."
